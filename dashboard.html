<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NutriScan AI - Dashboard</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🍎</text></svg>">
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4CAF50">
</head>
<body>
  <header>
    <div class="logo">🍎 NutriScan AI</div>
    <nav>
      <ul>
        <li><a href="home.html" data-testid="nav-home">Home</a></li>
        <li><a href="index.html" data-testid="nav-login">Login</a></li>
        <li><a href="input.html" data-testid="nav-scan">Scan Food</a></li>
        <li><a href="dashboard.html" class="active" data-testid="nav-dashboard">Dashboard</a></li>
        <li><a href="about.html" data-testid="nav-about">About</a></li>
        <li><a href="pricing.html" data-testid="nav-pricing">Pricing</a></li>
      </ul>
    </nav>
  </header>


  <main>
    <section class="dashboard-header">
      <h1>Your Food Dashboard</h1>
      <p>Smart inventory management with real expiry tracking. Items are sorted by urgency - act on expiring items to prevent waste!</p>
    </section>

    <!-- Recently Scanned Item Highlight -->
    <section id="recent-item-section" class="recent-item-highlight" style="display: none;">
      <h2>🆕 Just Scanned</h2>
      <div id="recentItemCard" class="recent-item-card"></div>
    </section>

    <!-- Expiry Alerts Section -->
    <section id="expiry-alerts-section" class="expiry-alerts" style="display: none;">
      <h2>⚠️ Expiry Alerts</h2>
      <div id="expiryAlerts" class="alert-grid"></div>
    </section>

    <section class="dashboard-summary">
      <h2>Your Total Impact</h2>
      <div class="summary-grid">
        <div class="summary-card">
          <h4>💰 Money Saved</h4>
          <p id="totalSavings" data-testid="total-savings">$0.00</p>
        </div>
        <div class="summary-card">
          <h4>💨 CO2 Reduced</h4>
          <p id="totalCo2" data-testid="total-co2">0.0 kg</p>
        </div>
        <div class="summary-card">
          <h4>💧 Water Conserved</h4>
          <p id="totalWater" data-testid="total-water">0 L</p>
        </div>
        <div class="summary-card">
          <h4>📦 Items Tracked</h4>
          <p id="totalItems" data-testid="total-items">0</p>
        </div>
      </div>
      <div class="dashboard-actions">
        <button id="exportCsvBtn" class="btn btn-secondary" data-testid="button-export-csv">📊 Export CSV</button>
        <button id="exportJsonBtn" class="btn btn-secondary" data-testid="button-export-json">💾 Export JSON</button>
        <button id="importDataBtn" class="btn btn-secondary" data-testid="button-import-data">📥 Import Data</button>
        <button id="exportPdfBtn" class="btn btn-secondary" data-testid="button-export-pdf">📄 Export PDF Report</button>
        <button id="generateShoppingListBtn" class="btn btn-secondary" data-testid="button-shopping-list">🛒 Shopping List</button>
        <button id="shareImpactBtn" class="btn btn-secondary" data-testid="button-share-impact">Share Your Impact</button>
        <button id="notificationBtn" class="btn btn-secondary" data-testid="button-toggle-notifications">🔔 Enable Notifications</button>
        <button id="clearStorageBtn" class="btn btn-danger" data-testid="button-clear-data">Clear All Data</button>
        <button id="upgradeBtn" class="btn btn-premium" data-testid="button-upgrade-premium">⭐ Upgrade to Premium</button>
      </div>
    </section>

    <!-- Import Data Modal -->
    <div id="importDataModal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h3>📥 Import Food Data</h3>
        <div class="import-options">
          <div class="import-method">
            <h4>Upload File</h4>
            <input type="file" id="fileImport" accept=".json,.csv" />
            <p class="import-help">Upload a JSON or CSV file with your food data</p>
          </div>
          <div class="import-method">
            <h4>Paste Data</h4>
            <textarea id="pasteImport" placeholder="Paste JSON data here..." rows="8"></textarea>
            <p class="import-help">Paste exported JSON data directly</p>
          </div>
        </div>
        <div class="modal-actions">
          <button id="processImportBtn" class="btn btn-primary">Import Data</button>
          <button id="cancelImportBtn" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
    </div>
    </section>

    <!-- Notification Settings Section -->
    <section id="notification-settings" class="notification-settings" style="display: none;">
      <h2>🔔 Notification Settings</h2>
      <div class="settings-grid">
        <div class="setting-card">
          <h4>Alert Timing</h4>
          <select id="notificationTiming">
            <option value="1">1 day before expiry</option>
            <option value="2" selected>2 days before expiry</option>
            <option value="7">1 week before expiry</option>
          </select>
        </div>
        <div class="setting-card">
          <h4>Notification Test</h4>
          <button id="testNotificationBtn" class="btn btn-small btn-primary">Send Test Notification</button>
        </div>
        <div class="setting-card">
          <h4>History</h4>
          <button id="viewNotificationHistoryBtn" class="btn btn-small btn-secondary">View History</button>
        </div>
      </div>
    </section>

    <!-- Notification History Modal -->
    <div id="notificationHistoryModal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h3>Notification History</h3>
        <div id="notificationHistoryList" class="notification-history">
          <p>No notifications sent yet.</p>
        </div>
      </div>
    </div>
    </section>

    <!-- Analytics & Insights Section -->
    <section id="analytics-section" class="analytics-section">
      <h2>📊 Analytics & Insights</h2>
      <div class="analytics-grid">
        <div class="analytics-card">
          <h4>📈 Waste Reduction Trend</h4>
          <div id="wasteTrendChart" class="chart-container">
            <div class="simple-chart">
              <div class="chart-bar" style="height: 60%"></div>
              <div class="chart-bar" style="height: 75%"></div>
              <div class="chart-bar" style="height: 90%"></div>
              <div class="chart-bar" style="height: 85%"></div>
            </div>
            <p class="chart-description">📈 15% improvement this month</p>
          </div>
        </div>
        
        <div class="analytics-card">
          <h4>🍎 Category Breakdown</h4>
          <div id="categoryChart" class="category-stats">
            <div class="category-item">
              <span class="category-name">Fruits</span>
              <div class="category-bar">
                <div class="category-fill" style="width: 40%"></div>
              </div>
              <span class="category-percent">40%</span>
            </div>
            <div class="category-item">
              <span class="category-name">Vegetables</span>
              <div class="category-bar">
                <div class="category-fill" style="width: 30%"></div>
              </div>
              <span class="category-percent">30%</span>
            </div>
            <div class="category-item">
              <span class="category-name">Dairy</span>
              <div class="category-bar">
                <div class="category-fill" style="width: 20%"></div>
              </div>
              <span class="category-percent">20%</span>
            </div>
          </div>
        </div>
        
        <div class="analytics-card">
          <h4>🎯 Monthly Goals</h4>
          <div class="goals-container">
            <div class="goal-item">
              <span>Waste Reduction</span>
              <div class="goal-progress">
                <div class="goal-bar" style="width: 75%"></div>
              </div>
              <span>75%</span>
            </div>
            <div class="goal-item">
              <span>Money Saved</span>
              <div class="goal-progress">
                <div class="goal-bar" style="width: 60%"></div>
              </div>
              <span>60%</span>
            </div>
          </div>
        </div>
        
        <div class="analytics-card">
          <h4>💡 Smart Insights</h4>
          <div class="insights-list">
            <div class="insight-item">
              <span class="insight-icon">🔍</span>
              <p>You save most money on vegetables - keep it up!</p>
            </div>
            <div class="insight-item">
              <span class="insight-icon">⚠️</span>
              <p>Dairy items expire fastest in your inventory</p>
            </div>
            <div class="insight-item">
              <span class="insight-icon">📅</span>
              <p>Best shopping day: Tuesday (prices 12% lower)</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="item-list-container">
      <div class="section-header">
        <h2>Your Food Inventory</h2>
        <div class="search-controls">
          <input type="text" id="searchInput" placeholder="Search your food items..." class="search-input">
          <button id="clearSearch" class="btn btn-small btn-secondary">Clear</button>
        </div>
        <div class="bulk-actions" id="bulkActions" style="display: none;">
          <div class="bulk-selection">
            <label class="bulk-select-all">
              <input type="checkbox" id="selectAll">
              <span>Select All</span>
            </label>
            <span id="selectedCount" class="selected-count">0 selected</span>
          </div>
          <div class="bulk-buttons">
            <button id="bulkDeleteBtn" class="btn btn-small btn-danger">Delete Selected</button>
            <button id="bulkMarkUsedBtn" class="btn btn-small btn-warning">Mark as Used</button>
            <button id="bulkExportBtn" class="btn btn-small btn-secondary">Export Selected</button>
            <button id="clearSelectionBtn" class="btn btn-small btn-secondary">Clear Selection</button>
          </div>
        </div>
        <div class="filter-controls">
          <select id="sortFilter" data-testid="sort-filter">
            <option value="urgency">Sort by Urgency</option>
            <option value="date">Sort by Purchase Date</option>
            <option value="name">Sort by Name</option>
            <option value="category">Sort by Category</option>
          </select>
          <select id="categoryFilter" data-testid="category-filter">
            <option value="all">All Categories</option>
            <option value="protein">Protein</option>
            <option value="dairy">Dairy</option>
            <option value="fruit">Fruits</option>
            <option value="vegetable">Vegetables</option>
            <option value="grain">Grains</option>
            <option value="pantry">Pantry</option>
          </select>
        </div>
      </div>
      <div id="itemList" class="item-grid">
        <p id="no-items-message" data-testid="no-items-message">You haven't scanned any items yet. <a href="input.html">Start scanning</a> to see your results!</p>
      </div>
    </section>
    
    <!-- Recipe Modal -->
    <div id="recipeModal" class="modal">
      <div class="modal-content">
        <span class="close-button" data-testid="button-close-modal">&times;</span>
        <div id="modal-body"></div>
      </div>
    </div>

    <!-- Usage Modal -->
    <div id="usageModal" class="modal">
      <div class="modal-content">
        <span class="close-usage-modal" data-testid="button-close-usage-modal">&times;</span>
        <h3>Update Item Usage</h3>
        <form id="usageForm">
          <div class="form-group">
            <label for="usedQuantity">How much did you use?</label>
            <input type="text" id="usedQuantity" placeholder="e.g., 1 lb, 2 cups, 3 pieces" required>
            <small class="form-hint">Enter the amount you consumed or used</small>
          </div>
          <div class="modal-actions">
            <button type="submit" class="btn btn-primary">Update Usage</button>
            <button type="button" class="btn btn-secondary" id="cancelUsage">Cancel</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Import Data Modal -->
    <div id="importDataModal" class="modal">
      <div class="modal-content">
        <span class="close-button" data-testid="button-close-import-modal">&times;</span>
        <h3>Import Data</h3>
        <div class="import-options">
          <div class="form-group">
            <label for="csvFileInput">Import from CSV file:</label>
            <input type="file" id="csvFileInput" accept=".csv" />
          </div>
          <div class="form-group">
            <label for="jsonDataInput">Or paste JSON data:</label>
            <textarea id="jsonDataInput" placeholder="Paste your JSON data here..." rows="6"></textarea>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-primary" id="importCsvBtn">Import CSV</button>
            <button type="button" class="btn btn-primary" id="importJsonBtn">Import JSON</button>
            <button type="button" class="btn btn-secondary" id="cancelImport">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Notification Settings Section -->
    <div id="notification-settings" class="notification-settings" style="display: none;">
      <div class="settings-content">
        <h3>Notification Settings</h3>
        <div class="form-group">
          <label>
            <input type="checkbox" id="enableNotifications" checked> Enable browser notifications
          </label>
        </div>
        <div class="form-group">
          <label for="notificationTiming">Notify me when items expire in:</label>
          <select id="notificationTiming">
            <option value="1">1 day</option>
            <option value="2" selected>2 days</option>
            <option value="3">3 days</option>
            <option value="7">1 week</option>
          </select>
        </div>
        <div class="settings-actions">
          <button type="button" class="btn btn-primary" id="saveNotificationSettings">Save Settings</button>
          <button type="button" class="btn btn-secondary" id="closeNotificationSettings">Close</button>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 NutriScan AI. All Rights Reserved.</p>
  </footer>

  <button id="refreshBtn">Refresh</button>

  <script src="script.js"></script>
</body>
</html>
